## ACL



<img width="468" height="156" alt="image" src="https://github.com/user-attachments/assets/bd6563f6-e90c-45c3-bbc6-40d61a8a7a04" />


Router(config)#access-list 1 deny host 192.168.10.1  ← acl 목록 <br/>
Router(config)#access-list 1 permit any   ← 나머지는 허용하겠다는 설정을 추가한다.<br/>
Router(config)#int f0/0<br/>
Router(config-if)#ip access-group 1 in  ← 인터페이스에 적용<br/>
<br/>
<br/>
Router(config)#ip access-list standard ACL_PC0  ← acl 목록<br/>
Router(config-std-nacl)#deny host 192.168.10.1<br/>
Router(config-std-nacl)#permit any<br/>
Router(config-std-nacl)#exit<br/>
Router(config)#int f0/0<br/>
Router(config-if)#ip access-group ACL_PC0 in ← 인터페이스에 적용<br/>
<br/>
<br/>


<img width="723" height="227" alt="image" src="https://github.com/user-attachments/assets/920003aa-8a12-4fb9-8bd9-31f14c590e5c" />

IOSvR1(config)#ip route 10.1.1.192 255.255.255.224 10.1.1.242 <br/>
IOSvR1(config)#ip route 10.1.1.224 255.255.255.240 10.1.1.242<br/>
IOSvR2(config)#ip route 10.1.1.0 255.255.255.128 10.1.1.241<br/>
IOSvR2(config)#ip route 10.1.1.128 255.255.255.192 10.1.1.241<br/>
<br/>
<br/>
IOSvR1(config)#ip access-list standard PERMIT<br/>
IOSvR1(config-std-nacl)#permit 10.1.1.242<br/>
IOSvR1(config-std-nacl)#deny any<br/>
<br/>
IOSvR1(config-std-nacl)#do sh ip access-list<br/>
Standard IP access list PERMIT<br/>
    10 permit 10.1.1.242<br/>
    20 deny   any<br/>
<br/>
IOSvR1(config)#ip access-list resequence PERMIT 100 50<br/>
<br/>
IOSvR1(config)#do sh access-list        <br/>              
Standard IP access list PERMIT<br/>
    100 permit 10.1.1.242<br/>
    150 deny   any<br/>
<br/>


<img width="704" height="277" alt="image" src="https://github.com/user-attachments/assets/667bf44b-da12-42a6-b5d1-d8fd0e3af8c5" />


#### R1 > A,D 영역만 NAT를 적용할 대상으로 지정한다.

ip access-list standard PERMIT_NAT<br/>
permit 10.1.1.0 0.0.0.127  <- (와일드카드 ID)    <br/>          
permit 10.1.1.224 0.0.0.15 <- (와일드카드 ID)    <br/>

IOSvR1(config)#ip nat inside source list PERMIT_NAT interface g0/3 <br/>
IOSvR1(config)#int g0/3<br/>
IOSvR1(config-if)#ip nat outside <br/>
IOSvR1(config-if)#int range g0/0-2<br/>
IOSvR1(config-if-range)#ip nat inside <br/>
<br/>
IOSvR2(config)#ip route 0.0.0.0 0.0.0.0 10.1.1.241

#### R2 > webterm 만 외부망의 접속이 가능하게 설정한다.

IOSvR2(config)#ip access-list standard PERMIT_WEBTERM<br/>
IOSvR2(config-std-nacl)#permit host 10.1.1.237<br/>
IOSvR2(config-std-nacl)#deny any log<br/>
IOSvR2(config-std-nacl)#int g0/2<br/>
IOSvR2(config-if)#ip access-group PERMIT_WEBTERM in<br/>


#### 연습

ip access-list extended PERMIT<br/>
10 permit ip host 10.1.1.242 host 10.1.1.241<br/>
20 deny   ip any any log<br/>
IOSvR1(config-ext-nacl)#int g0/0<br/>
IOSvR1(config-if)#ip access-group PERMIT in<br/>

ip access-list extended PERMIT<br/>
IOSvR1(config-ext-nacl)#10 deny ip host 10.1.1.242 host 10.1.1.241<br/>
IOSvR1(config-ext-nacl)#20 permit ip any any<br/>



#### R1 -> C영역에서 A 영역으로 접속만 허용 , 나머지는 차단

ip access-list standard PERMIT_E <br/>
IOSvR1(config-ext-nacl)#10 permit ip 10.1.1.192 0.0.0.31 10.1.1.0 0.0.0.127<br/>
IOSvR1(config-ext-nacl)#20 deny ip any any<br/>

#### R1> Webterm에서 R1으로 Http를 이용한 접속을 허용
IOSvR1(config-ext-nacl)#15 permit tcp host 10.1.1.237 host 10.1.1.241 eq 80

#### R1> Webterm에서 Toolbox으로 Http를 이용한 접속을 허용
IOSvR1(config-ext-nacl)#16 permit tcp host 10.1.1.237 host 10.1.1.126 eq 80

#### R1 > g0/0에 적용된 ACL 삭제



#### R2 > R1에서 R2로의 telnet,ssh 접속 차단, icmp만 허용

ip access-list extended PERMIT<br/>
deny tcp host 10.1.1.241(상대 ip) host 10.1.1.242 (본인 ip) eq telnet<br/>
deny tcp host 10.1.1.241(상대 ip) host 10.1.1.242 (본인 ip) eq 22 (ssh)<br/>
deny tcp host 10.1.1.241(상대 ip) host 10.1.1.242 (본인 ip) eq 23 (ssh)<br/>
<br/>
permit ip any any<br/>
<br/>
exit<br/>
ip accesss-group PERMIT in<br/>


결과 - 
Extended IP access list PERMIT<br/>
    10 deny tcp host 10.1.1.241 host 10.1.1.242 eq telnet (1 match)<br/>
    20 deny tcp host 10.1.1.241 host 10.1.1.242 eq 22 (1 match)<br/>
    25 permit icmp host 10.1.1.241 host 10.1.1.242<br/>
    30 deny ip any any (22 matches)<br/>


#### R2에서 tcp/udp 를 사용하는 dns 관련 포트는 차단하고, 나머지는 허용하시오.

Extended IP access list PERMIT<br/>
     5 deny tcp host 10.1.1.237 any eq domain (70 matches)<br/>
    10 deny udp host 10.1.1.237 any eq domain (70 matches)<br/>
    20 permit ip any any (68 matches)<br/>


#### R2에 설정된 ACL 기존 설정 삭제

R1에서 설정<br/>
- 좌측 Webterm에서 출발하는 dns 관련 패킷은 차단<br/>
- 좌측 Webterm에서 출발하는 R2를 대상으로 하는 HTTP 패킷은 허용<br/>
- 좌측 Webterm에서 출발하는 Toolbox를 대상으로 하는 HTTP 패킷은 허용<br/>
- 나머지는 모두 차단<br/>
<br/>
<br/>
IOSvR1(config-ext-nacl)#ip access-list standard PERMIT_NAT<br/>
IOSvR1(config-std-nacl)#do sh access-list<br/>
Standard IP access list PERMIT_NAT<br/>
    10 permit 10.1.1.0, wildcard bits 0.0.0.127 (1 match)<br/>
    20 permit 10.1.1.224, wildcard bits 0.0.0.15 (165 matches)<br/>
Extended IP access list PERMIT<br/>
IOSvR1(config-std-nacl)#15 permit 10.1.1.128 0.0.0.63           <br/>     
IOSvR1(config-std-nacl)#do sh access-list<br/>
Standard IP access list PERMIT_NAT<br/>
    10 permit 10.1.1.0, wildcard bits 0.0.0.127 (1 match)<br/>
    15 permit 10.1.1.128, wildcard bits 0.0.0.63<br/>
    20 permit 10.1.1.224, wildcard bits 0.0.0.15 (165 matches)<br/>
Extended IP access list PERMIT<br/>
IOSvR1(config-std-nacl)#do ping 8.8.8.8 so g0/2<br/>
<br/>
IOSvR1(config-ext-nacl)#do sh access-list<br/>
Standard IP access list PERMIT_NAT<br/>
    10 permit 10.1.1.0, wildcard bits 0.0.0.127 (1 match)<br/>
    15 permit 10.1.1.128, wildcard bits 0.0.0.63 (32 matches)<br/>
    20 permit 10.1.1.224, wildcard bits 0.0.0.15 (171 matches)<br/>
Extended IP access list PERMIT<br/>
    10 deny udp host 10.1.1.189 any eq domain (286 matches)<br/>
    20 permit tcp host 10.1.1.189 host 10.1.1.242 eq www<br/>
    30 permit tcp host 10.1.1.189 host 10.1.1.126 eq www (1 match)<br/>
    40 deny ip any any<br/>
IOSvR1(config-ext-nacl)#<br/>
<br/>
<br/>
┌──(root㉿KaliLinuxCLI-1)-[/]<br/>
└─# history<br/>
    1  hping3 -1 8.8.8.8<br/>
    2  nping 8.8.8.8<br/>
    3  nmap --version<br/>
    4  nmap --help<br/>
    5  nmap -v -sn 10.1.1.0/25<br/>
    6  nmap -v -sn 10.1.1.240/30<br/>
    7  nmap -v -sn 10.1.1.192/27<br/>
    8  nmap -v -sn 10.1.1.224/28<br/>
    9  nmap -v -sS 10.1.1.129<br/>
   10  nmap -v -sV 10.1.1.129 -p 22,23,80<br/>
   11  nmap -v -sV -Pn -T4 10.1.1.129 -p 22,23,80<br/>
   12  ls<br/>
   13  ll<br/>
   14  nmap -v -sV -Pn -T4 10.1.1.129 -p 22,23,80 -oN results.txt<br/>
   15  ll<br/>
   16  history<br/>
<br/>
┌──(root㉿KaliLinuxCLI-1)-[/]<br/>
└─# nmap -v -sV -Pn -T4 -sU 10.1.1.129 -p 53 <br/>
<br/>
<br/>
┌──(root㉿KaliLinuxCLI-1)-[/]<br/>
└─# hping3 -1 --icmptype 8 -c 2 10.1.1.129<br/>
<br/>
┌──(root㉿KaliLinuxCLI-1)-[/]<br/>
└─# hping3 -1 --icmptype 0 -c 2 10.1.1.129 <br/>
<br/>











