
## ASAv

#### pfsense - CLI, GUI 방식 모두 가능
#### asa - CLI, GUI 방식 모두 가능

시스코 라우터, 스위치 명령어와 거의 비슷하게 다룰수 있기 때문에 CLI 방식을 더 선호 하는 편이다.<br/>
VNC에서는 콘솔프로그램(MOBA, SCRT 등)의 편리한 기능을 활용할 수 없다.<br/>

그래서, 이 단점을 개선하기 위해… CONSOLE TYPE을 vnc → telnet 으로 전환을 한다.<br/>
선택만 변경이 안되기 때문에 아래와 같은 명령어를 수동으로 입력을 한다.<br/>

en<br/>
password:<br/>
cont f<br/>
cd coredumpinfo<br/>
copy coredump.cfg disk0:/use_ttyS0<br/>
wr<br/>

전원 Off<br/>
configure<br/>
type telnet으로 변경<br/>

<img width="690" height="360" alt="image" src="https://github.com/user-attachments/assets/e3dc1887-2caa-43be-99d8-e0ba773bbf3c" />

#### 인터페이스를 정상적으로 동작(활성화) 시키기 위해서는 총 4가지가 필요하다.
(ip입력, no sh, name, security level 지정)

ciscoasa(config-if)# sh run int g0/0<br/>
!<br/>
interface GigabitEthernet0/0<br/>
 no nameif<br/>
 no security-level<br/>
 ip address 1.1.30.3 255.255.255.0 <br/>
ciscoasa(config-if)# nameif outside<br/>
INFO: Security level for "outside" set to 0 by default.<br/>
ciscoasa(config-if)# security-level 0<br/>
ciscoasa(config-if)# sh run int g0/0 <br/>
!<br/>
interface GigabitEthernet0/0<br/>
 nameif outside<br/>
 security-level 0<br/>
 ip address 1.1.30.3 255.255.255.0<br/> 


<img width="528" height="212" alt="image" src="https://github.com/user-attachments/assets/3ca4b7d9-6c8b-4ee4-834d-f8fea9c4b626" />



0 -> 50 -> 100은 불가능하지만 100 -> 50 -> 0은 가능함

<img width="512" height="349" alt="image" src="https://github.com/user-attachments/assets/0e1b8918-3f40-453d-8a64-3e726014d517" />

ciscoasa(config-if)# INT G0/1<br/> 
ciscoasa(config-if)# ip add 192.168.20.1 255.255.255.0<br/> 
ciscoasa(config-if)# nameif inside<br/> 
INFO: Security level for "inside" set to 100 by default.(inside는 100으로 세팅하겠다)<br/> 
ciscoasa(config-if)# security-level 100<br/> 
ciscoasa(config-if)# no sh<br/> 

ciscoasa(config-if)# INT G0/0<br/> 
ciscoasa(config-if)# ip add 1.1.30.3 255.255.255.0<br/> 
ciscoasa(config-if)# nameif outside<br/> 
INFO: Security level for "inside" set to 100 by default.<br/> 
ciscoasa(config-if)# security-level 0<br/> 
ciscoasa(config-if)# no sh<br/> 

방화벽을 라우터 처럼 동작시킨다.
router rip<br/> 
version 2<br/> 
no auto-summary<br/> 
network 1.0.0.0<br/> 
network 192.168.20.0<br/> 

ASA에서 사용하는 기본 정책맵(policy-map) 이고, 검사할 프로토콜 목록이다. <br/> 
주로 7계층(응용)의 프로토콜이 보이며, 내부에서 출발하는 트래픽을 분석, 추적하며 정상적으로 동작하는지 확인한다. 이상이 없으면 허용한다.<br/> 

가능한 이유는 (상태/세션) 기반 동작(Stateful방식)을 하기때문에 돌아오는(응답) 패킷을 예측할 수 있게 된다.

즉, 아래 항목들이 내부에서 출발할 경우 돌아오는 패킷은 이상이 없으면 허용한다.

반대로 외부에서 출발하는 패킷은 허용하지 않는다. 응답을 허용하기 위해서는 ACL를 사용한다.

stateful 방화벽: asa, pfsense 등, 내부망에서 요청을 보낸 경우에만 응답을 허용한다.

stateless 방화벽: ufw, iptables 등, 세션/상태를 기억하지 않고 사전에 정의된 룰에 의해서만 패킷이 필터링된다.


ciscoasa(config)# policy-map global_policy<br/> 
ciscoasa(config-pmap)#  class inspection_default   ← 방화벽에서 설정한 기본 검사 항목<br/> 
ciscoasa(config-pmap-c)#   inspect icmp   ← icmp 를 정책맵의 기본 항목에 포함시켜준다.<br/> 
<br/> 
ciscoasa(config-pmap-c)# sh run policy-map global_policy<br/> 
!<br/> 
policy-map global_policy<br/> 
 class inspection_default<br/> 
  inspect icmp   ← 포함되었다.<br/> 

DMZ 인터페이스 설정<br/> 
ciscoasa(config-if)# int g0/2<br/> 
ciscoasa(config-if)# ip add 172.16.20.1 255.255.255.0<br/> 
ciscoasa(config-if)# no sh<br/> 
ciscoasa(config-if)# nameif DMZ<br/> 
ciscoasa(config-if)# security-level 50<br/> 
<br/> 

라우터에서 추가한 DMZ 영역을 RIP에 포함<br/> 

ciscoasa# sh run | begin rip  <br/> 
router rip<br/> 
 network 1.0.0.0<br/> 
 network 172.16.0.0<br/> 
 network 192.168.20.0<br/> 
 version 2<br/> 
 no auto-summary<br/> 



















































































































































































































































































































































































