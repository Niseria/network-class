
### 이중화 및 부하 분산(Redundancy & Load Balancing) 실습

<img width="799" height="321" alt="image" src="https://github.com/user-attachments/assets/fd406cc1-3122-45a1-b69a-08d21e93e0bc" />

L2: STP Root Bridge 조정을 통한 VLAN별 트래픽 분산
L3: HSRP를 이용한 게이트웨이 이중화 및 업링크 트래킹(Tracking)


#### Step 1: 2계층 설정 (STP Root 조정)

각 스위치가 특정 VLAN의 주인(Root)이 되도록 설정하여 부하를 분산합니다.

[SW1] VLAN 10 Root / VLAN 20 Secondary<br/>
[SW2] VLAN 20 Root / VLAN 10 Secondary<br/>

스위치 사이 구간 trunk 설정 및 vlan 생성<br/>
int range g0/0-3<br/>
switchport trunk encapsulation dot1q <br/>
switchport mode tr <br/>
vlan 10<br/>
vlan 20<br/>

Switch(config)#spanning-tree vlan 10 root primary diameter 4<br/>
Switch(config)#spanning-tree vlan 20 root secondary diameter 4<br/>


#### Step 2: 3계층 설정 (HSRP 및 Tracking 구현)
**라우터 서브 인터페이스에 HSRP**를 적용하고, 업링크(g1/0) 장애 발생 시 우선순위를 낮춰 자동으로 절체되도록 설정합니다.

[R1] HSRP Grp 1 active / Grp 2 standby<br/>
[R2] HSRP Grp 2 active / Grp 1 standby<br/>


R1(config-subif)#int g0/0.10<br/>
R1(config-subif)#standby 1 priority 105<br/>
R1(config-subif)#standby 1 preempt <br/>
R1(config-subif)#int g0/0.20           <br/>
R1(config-subif)#standby 2 priority 95 <br/>
R1(config-subif)#standby 2 preempt <br/>

R2(config-subif)#int g0/0.10<br/>
R2(config-subif)#stand<br/>
R2(config-subif)#standby 1 pri<br/>
R2(config-subif)#standby 1 priority 95<br/>
R2(config-subif)#standby 1 preempt <br/>
R2(config-subif)#int g0/0.20          <br/>
R2(config-subif)#standby 2 priority 105<br/>
R2(config-subif)#standby 2 preempt <br/>


#### 확인
HSRP 상태 확인: show standby brief<br/>
R1: Grp 1 Active, Grp 2 Standby<br/>
R2: Grp 1 Standby, Grp 2 Active<br/>
<br/>
STP 상태 확인: show spanning-tree vlan 10, 20<br/>
SW1: This bridge is the root<br/>
<br/>
Tracking 동작 확인 (장애 시뮬레이션)<br/>
동작: R1의 g1/0 인터페이스를 shutdown 시킴.<br/>
확인: R1의 Priority가 감소(105 → 85)하고, R2가 Grp 1의 Active 상태를 가져오는지 확인.<br/>


R1(config-if)#do sh standby br<br/>
                     P indicates configured to preempt.<br/>
                     |<br/>
Interface   Grp  Pri P State   Active          Standby         Virtual IP<br/>
Gi0/0.10    1    85  P Standby 10.1.1.252      local           10.1.1.254<br/>
Gi0/0.20    2    75  P Standby 20.1.1.252      local           20.1.1.254<br/>

<img width="1086" height="409" alt="image" src="https://github.com/user-attachments/assets/08076554-8228-4d0e-be61-f712fb2338e1" />


게이트웨이 이중화 프로토콜의 위치를 스위치로 옮겨서 네트워크 구조를 간소화 시킨다. 효율성을 향상 시킨다.

SW1><br/>
interface Vlan10<br/>
 ip address 10.1.1.253 255.255.255.0<br/>
 vrrp 1 ip 10.1.1.254<br/>
 vrrp 1 priority 105<br/>
!<br/>
interface Vlan20<br/>
 ip address 20.1.1.253 255.255.255.0<br/>
 vrrp 2 ip 20.1.1.254<br/>
 vrrp 2 priority 95<br/>
!<br/>
router ospf 1<br/>
 router-id 3.3.3.3<br/>
 redistribute connected subnets<br/>
 network 30.1.1.0 0.0.0.255 area 0<br/>
<br/>
SW2><br/>
interface Vlan10<br/>
 ip address 10.1.1.252 255.255.255.0<br/>
 vrrp 1 ip 10.1.1.254<br/>
 vrrp 1 priority 95<br/>
!<br/>
interface Vlan20<br/>
 ip address 20.1.1.252 255.255.255.0<br/>
 vrrp 2 ip 20.1.1.254<br/>
 vrrp 2 priority 105<br/>
!<br/>
router ospf 1<br/>
 router-id 4.4.4.4<br/>
 redistribute connected subnets<br/>
 network 40.1.1.0 0.0.0.255 area 0<br/>
R1><br/>
router ospf 1<br/>
 router-id 1.1.1.1<br/>
 network 30.1.1.0 0.0.0.255 area 0<br/>
 default-information originate<br/>
<br/>
R2><br/>
router ospf 1<br/>
 router-id 2.2.2.2<br/>
 network 30.1.1.0 0.0.0.255 area 0<br/>
 default-information originate<br/>




























































































































































































































































